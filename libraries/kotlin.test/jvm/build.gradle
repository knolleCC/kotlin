description = 'Kotlin Test'

apply plugin: 'kotlin-platform-jvm'

configureJvm6Project(project)
configureDist(project)
configurePublishing(project)

sourceSets {
    java9
}

dependencies {
    expectedBy project(':kotlin-test:kotlin-test-common')
    compile project(':kotlin-stdlib')
    testCompile project(":kotlin-test:kotlin-test-junit")
    testCompile('junit:junit:4.12')
}


archivesBaseName = 'kotlin-test'

createJava9ModuleInfoTask(project, "compileJava9ModuleInfo", "kotlin.test")

jar {
    manifestAttributes(manifest, project, 'Test', true)
    from compileJava9ModuleInfo.outputs
}

artifacts {
    archives sourcesJar
    archives javadocJar
}

dist {
    from (jar, sourcesJar)
}

compileKotlin {
    // TODO: Why "-Xmulti-platfrom" ?
    kotlinOptions.freeCompilerArgs = ["-Xallow-kotlin-package", "-Xnormalize-constructor-calls=enable",
                                      "-Xmulti-platform", "-module-name", project.archivesBaseName]
}

compileTestKotlin {
    kotlinOptions.freeCompilerArgs = ["-Xallow-kotlin-package"]
}
